{% extends 'base.html.twig' %}

{% block body %}
    <!-- Page Content -->
    <!-- Banner Starts Here -->
    <div class="banner header-text">
        <div class="owl-banner owl-carousel">
            <div class="banner-item-01">
                <div class="text-content">
                    <h4>Best Offer</h4>
                    <h2>New Arrivals On Sale</h2>
                </div>
            </div>
            <div class="banner-item-02">
                <div class="text-content">
                    <h4>Flash Deals</h4>
                    <h2>Get your best products</h2>
                </div>
            </div>
            <div class="banner-item-03">
                <div class="text-content">
                    <h4>Last Minute</h4>
                    <h2>Grab last minute deals</h2>
                </div>
            </div>
        </div>
    </div>
    <!-- Banner Ends Here -->

    {#
        В админке: добавить загрузку фото
        добавить кнопку купить
        добавить символ рубля
        добавить столбец dateUpdate в таблицу product
    #}
    <div class="latest-products">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="section-heading">
                        <h2>Новинки</h2>
                        <a href="products.html">Посмотреть все продукты <i class="fa fa-angle-right"></i></a>
                    </div>
                </div>
                {% for product in products %}
                    <div class="col-md-4">
                        <div class="product-item">
                            <a href="#"><img src="https://designboom.ru/upload/iblock/139/139a970b1c1d6a1b4e220759b0a8adf5.jpeg" alt=""></a>
                            <div class="down-content">
                                <a href="#"><h4>{{ product.name }}</h4></a>
                                <h6>{{ product.price }} р.</h6>
                                <p>{{ product.description }}</p>
{#                                <ul class="stars">#}
{#                                    <li><i class="fa fa-star"></i></li>#}
{#                                    <li><i class="fa fa-star"></i></li>#}
{#                                    <li><i class="fa fa-star"></i></li>#}
{#                                    <li><i class="fa fa-star"></i></li>#}
{#                                    <li><i class="fa fa-star"></i></li>#}
{#                                </ul>#}
{#                                <span>Reviews (24)</span>#}
                            </div>
                        </div>
                    </div>
                {% endfor %}
{#                <div class="col-md-4">#}
{#                    <div class="product-item">#}
{#                        <a href="#"><img src="assets/images/product_01.jpg" alt=""></a>#}
{#                        <div class="down-content">#}
{#                            <a href="#"><h4>Tittle goes here</h4></a>#}
{#                            <h6>$25.75</h6>#}
{#                            <p>Lorem ipsume dolor sit amet, adipisicing elite. Itaque, corporis nulla aspernatur.</p>#}
{#                            <ul class="stars">#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                            </ul>#}
{#                            <span>Reviews (24)</span>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}
{#                <div class="col-md-4">#}
{#                    <div class="product-item">#}
{#                        <a href="#"><img src="assets/images/product_02.jpg" alt=""></a>#}
{#                        <div class="down-content">#}
{#                            <a href="#"><h4>Tittle goes here</h4></a>#}
{#                            <h6>$30.25</h6>#}
{#                            <p>Lorem ipsume dolor sit amet, adipisicing elite. Itaque, corporis nulla aspernatur.</p>#}
{#                            <ul class="stars">#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                            </ul>#}
{#                            <span>Reviews (21)</span>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}
{#                <div class="col-md-4">#}
{#                    <div class="product-item">#}
{#                        <a href="#"><img src="assets/images/product_03.jpg" alt=""></a>#}
{#                        <div class="down-content">#}
{#                            <a href="#"><h4>Tittle goes here</h4></a>#}
{#                            <h6>$20.45</h6>#}
{#                            <p>Sixteen Clothing is free CSS template provided by TemplateMo.</p>#}
{#                            <ul class="stars">#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                            </ul>#}
{#                            <span>Reviews (36)</span>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}
{#                <div class="col-md-4">#}
{#                    <div class="product-item">#}
{#                        <a href="#"><img src="assets/images/product_04.jpg" alt=""></a>#}
{#                        <div class="down-content">#}
{#                            <a href="#"><h4>Tittle goes here</h4></a>#}
{#                            <h6>$15.25</h6>#}
{#                            <p>Lorem ipsume dolor sit amet, adipisicing elite. Itaque, corporis nulla aspernatur.</p>#}
{#                            <ul class="stars">#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                            </ul>#}
{#                            <span>Reviews (48)</span>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}
{#                <div class="col-md-4">#}
{#                    <div class="product-item">#}
{#                        <a href="#"><img src="assets/images/product_05.jpg" alt=""></a>#}
{#                        <div class="down-content">#}
{#                            <a href="#"><h4>Tittle goes here</h4></a>#}
{#                            <h6>$12.50</h6>#}
{#                            <p>Lorem ipsume dolor sit amet, adipisicing elite. Itaque, corporis nulla aspernatur.</p>#}
{#                            <ul class="stars">#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                            </ul>#}
{#                            <span>Reviews (16)</span>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}
{#                <div class="col-md-4">#}
{#                    <div class="product-item">#}
{#                        <a href="#"><img src="assets/images/product_06.jpg" alt=""></a>#}
{#                        <div class="down-content">#}
{#                            <a href="#"><h4>Tittle goes here</h4></a>#}
{#                            <h6>$22.50</h6>#}
{#                            <p>Lorem ipsume dolor sit amet, adipisicing elite. Itaque, corporis nulla aspernatur.</p>#}
{#                            <ul class="stars">#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                                <li><i class="fa fa-star"></i></li>#}
{#                            </ul>#}
{#                            <span>Reviews (32)</span>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function(){
            let currentCart = JSON.parse(localStorage.getItem('cart'));
            document.querySelectorAll('.buy-click').forEach((item) => {
                if(currentCart[item.getAttribute('data-id')]) {
                    item.classList.add('d-none');
                    item.nextSibling.nextElementSibling.classList.remove('d-none');
                    item.nextSibling.nextElementSibling.querySelector('input').value = currentCart[item.getAttribute('data-id')];
                }
            });
        });
        console.log('start2');
        const buy = (_that) => {
            let localCart  = localStorage.getItem('cart');
            if (localCart) {
                localCart = JSON.parse(localCart);
                localCart[_that.getAttribute('data-id')] = 1;
            } else {
                localCart = {
                    [_that.getAttribute('data-id')]: 1
                };
            }
            localStorage.setItem('cart', JSON.stringify(localCart));
            _that.nextSibling.nextElementSibling.classList.remove('d-none');
            _that.nextSibling.nextElementSibling.querySelector('input').value = '1';
            _that.classList.add('d-none');
        }

        const minus = (_that) => {
            let localCart  = JSON.parse(localStorage.getItem('cart'));
            if (localCart[_that.getAttribute('data-id')] === 1) {
                delete localCart[_that.getAttribute('data-id')];
                _that.parentNode.parentNode.classList.add('d-none');
                _that.parentNode.parentNode.previousElementSibling.classList.remove('d-none');
            } else {
                localCart[_that.getAttribute('data-id')] = localCart[_that.getAttribute('data-id')] - 1;
                _that.parentNode.nextElementSibling.value = localCart[_that.getAttribute('data-id')];
            }
            localStorage.setItem('cart', JSON.stringify(localCart));
        }

        const plus = (_that) => {
            let localCart  = JSON.parse(localStorage.getItem('cart'));
            localCart[_that.getAttribute('data-id')] = localCart[_that.getAttribute('data-id')] + 1;
            localStorage.setItem('cart', JSON.stringify(localCart));
            _that.parentNode.previousElementSibling.value = localCart[_that.getAttribute('data-id')];
        };

        const onInput = (_that) => {
            let localCart  = JSON.parse(localStorage.getItem('cart'));
            if (_that.value === 0) {
                delete localCart[_that.getAttribute('data-id')];
                _that.parentNode.classList.add('d-none');
                _that.parentNode.previousElementSibling.classList.remove('d-none');
            } else {
                localCart[_that.getAttribute('data-id')] = Number(_that.value);
            }
            localStorage.setItem('cart', JSON.stringify(localCart));
        }

    </script>
{% endblock %}
